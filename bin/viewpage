#!/usr/bin/php
<?php

require('sys/base.php');
ModuleManager::load('lepton.base.mvc');

class MvcInvoker extends ConsoleApplication {
	protected $arguments = 'hv';
	private $verbose = false;
	function usage() { 
		Console::writeLn('usage:    %s [-options] [controller [method [argument ...]]]', $this->getName());
		Console::writeLn('options:  -v      Verbose output');
		Console::writeLn('          -h      Show help');
	}
	function main($argc,$argv) {
		if (isset($this->options['v'])) $this->verbose = true;
		$pc = $this->getParameterCount();
		$ctl = NULL; $mtd = NULL; $args = array();
		if ($pc>0) $ctl = $this->getParameter(0);
		if ($pc>1) $mtd = $this->getParameter(1);
		if ($pc>2) $args = $this->getParameterSlice(2); 

		if ($this->verbose) 
			Console::writeLn("Preparing to invoke %s:%s with %d arguments", (($ctl==NULL)?'NULL':$ctl), (($mtd==NULL)?'NULL':$mtd), count($args));

		Controller::invoke($ctl,$mtd,$args);
		return 0;
	}
}

Lepton::run('MvcInvoker');

?>
